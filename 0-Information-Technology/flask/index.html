


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Data Engineering, Data Science, Business Analytics, Data Visualization, Business Intelligence">
      
      
        <meta name="author" content="Vaibhav Yadav - Data Engineer, Scientist and Analyst">
      
      
        <link rel="canonical" href="https://iYadavVaibhav.github.io/wiki/0-Information-Technology/flask/">
      
      
        <link rel="prev" href="../aws-amazon-web-services/">
      
      
        <link rel="next" href="../flutter/">
      
      <link rel="icon" href="../../assets/images/apple-touch-icon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.2">
    
    
      
        <title>Flask - Vaibhav Yadav's Wiki</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7bf56d0a.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#flask" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Vaibhav Yadav&#39;s Wiki" class="md-header__button md-logo" aria-label="Vaibhav Yadav's Wiki" data-md-component="logo">
      
  <img src="../../assets/images/apple-touch-icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vaibhav Yadav's Wiki
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Flask
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/iYadavVaibhav/wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    iyadavvaibhav/wiki
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Vaibhav Yadav&#39;s Wiki" class="md-nav__button md-logo" aria-label="Vaibhav Yadav's Wiki" data-md-component="logo">
      
  <img src="../../assets/images/apple-touch-icon.png" alt="logo">

    </a>
    Vaibhav Yadav's Wiki
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/iYadavVaibhav/wiki" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    iyadavvaibhav/wiki
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home iYV
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          0 Information Technology
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          0 Information Technology
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aws-amazon-web-services/" class="md-nav__link">
        Amazon Web Services
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Flask
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Flask
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#flask-hello-world" class="md-nav__link">
    Flask Hello World
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-a-flask-app-ways" class="md-nav__link">
    Run a Flask App - Ways
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flask-native-modules" class="md-nav__link">
    Flask native modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#templates-in-flask" class="md-nav__link">
    Templates in Flask
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flask-extensions" class="md-nav__link">
    Flask Extensions
  </a>
  
    <nav class="md-nav" aria-label="Flask Extensions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bootstrap-in-flask" class="md-nav__link">
    Bootstrap in Flask
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#moment-js-in-flask" class="md-nav__link">
    Moment JS in Flask
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forms-in-flask" class="md-nav__link">
    Forms in Flask
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#databases-in-flask" class="md-nav__link">
    Databases in Flask
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#emails-in-flask" class="md-nav__link">
    Emails in Flask
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blueprint-large-app-structure-in-flask" class="md-nav__link">
    Blueprint - Large App Structure in Flask
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-in-flask" class="md-nav__link">
    Testing in Flask
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flutter/" class="md-nav__link">
        Flutter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../google-cloud-platform/" class="md-nav__link">
        Google Cloud Platform
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../javascript-notes/" class="md-nav__link">
        JavaScript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../material-mkdocs/" class="md-nav__link">
        Material for MkDocs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nativescript-notes/" class="md-nav__link">
        NativeScript
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pelican/" class="md-nav__link">
        Pelican
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../python-notes/" class="md-nav__link">
        Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../r-language/" class="md-nav__link">
        R and R-Studio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../react-js-notes/" class="md-nav__link">
        ReactJS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../text-editors/" class="md-nav__link">
        Text Editors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools-frameworks/" class="md-nav__link">
        Tools and Frameworks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../virtual-box/" class="md-nav__link">
        Virtual Box
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../web-server-config/" class="md-nav__link">
        Web Server Config
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          1 Software Engineering
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          1 Software Engineering
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/cs-se-basics/" class="md-nav__link">
        CSE Basics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/data-structures-algorithms/" class="md-nav__link">
        Data Structures & Algorithms
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/git/" class="md-nav__link">
        Git and GitHub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/js-ecma6-notes/" class="md-nav__link">
        ECMA 6+
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/linux-terminal/" class="md-nav__link">
        Linux Terminal
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/oops-python/" class="md-nav__link">
        OOPs in Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/regex/" class="md-nav__link">
        Regex
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/software-diagrams/" class="md-nav__link">
        Software Diagrams
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../1-Software-Engineering/web-development/" class="md-nav__link">
        Web Development
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          2 Data Engineering
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          2 Data Engineering
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-Data-Engineering/data-architecture/" class="md-nav__link">
        Data Architecture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-Data-Engineering/data-python/" class="md-nav__link">
        SQL Operations in Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-Data-Engineering/data-science/" class="md-nav__link">
        Data Science
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-Data-Engineering/data-solutions/" class="md-nav__link">
        Data Solutions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-Data-Engineering/data-tools-frameworks/" class="md-nav__link">
        Data Tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-Data-Engineering/databases/" class="md-nav__link">
        Databases & SQL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-Data-Engineering/etl_pipelines/" class="md-nav__link">
        ETL Pipelines
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-Data-Engineering/python-data-wrangling/" class="md-nav__link">
        Python Data Wrangling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../2-Data-Engineering/tableau/" class="md-nav__link">
        Tableau
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          3 Management & Strategy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          3 Management & Strategy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3-Management-%26-Strategy/ajile-sprint-scrum/" class="md-nav__link">
        Agile, Scrum and Sprints
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../3-Management-%26-Strategy/project-management/" class="md-nav__link">
        Project Management
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          4 Functional & Business
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          4 Functional & Business
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../4-Functional-%26-Business/banking-notes/" class="md-nav__link">
        Banking and Finance
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          5 Personal Development
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          5 Personal Development
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../5-Personal-Development/pd-courses/" class="md-nav__link">
        Personal Development Courses
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          6 Math & Logic
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          6 Math & Logic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../6-Math-%26-Logic/probability/" class="md-nav__link">
        Probability
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          7 Other
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          7 Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../7-Other/electronics-notes/" class="md-nav__link">
        Electronics & IoT
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
      
      
      
        <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
          8 Blog & Articles
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          8 Blog & Articles
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8-Blog-%26-Articles/fake-data-using-faker/" class="md-nav__link">
        How to Create fake data using Faker
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8-Blog-%26-Articles/github-pages-jekyll/" class="md-nav__link">
        Jekyll on Github
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8-Blog-%26-Articles/hello-humans/" class="md-nav__link">
        Hello Humans
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../8-Blog-%26-Articles/syntax-highlight-jekyll/" class="md-nav__link">
        Jekyll Syntax Highlight
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
      
      
      
        <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
          9 Drafts
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          9 Drafts
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/mongodb-notes/" class="md-nav__link">
        Mongo DB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../9-Drafts/notepad/" class="md-nav__link">
        Notepad
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#flask-hello-world" class="md-nav__link">
    Flask Hello World
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-a-flask-app-ways" class="md-nav__link">
    Run a Flask App - Ways
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flask-native-modules" class="md-nav__link">
    Flask native modules
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#templates-in-flask" class="md-nav__link">
    Templates in Flask
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flask-extensions" class="md-nav__link">
    Flask Extensions
  </a>
  
    <nav class="md-nav" aria-label="Flask Extensions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bootstrap-in-flask" class="md-nav__link">
    Bootstrap in Flask
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#moment-js-in-flask" class="md-nav__link">
    Moment JS in Flask
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#forms-in-flask" class="md-nav__link">
    Forms in Flask
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#databases-in-flask" class="md-nav__link">
    Databases in Flask
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#emails-in-flask" class="md-nav__link">
    Emails in Flask
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blueprint-large-app-structure-in-flask" class="md-nav__link">
    Blueprint - Large App Structure in Flask
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-in-flask" class="md-nav__link">
    Testing in Flask
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                

    
                  

  
    <a href="https://github.com/iYadavVaibhav/wiki/edit/master/docs/0-Information-Technology/flask.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/iYadavVaibhav/wiki/raw/master/docs/0-Information-Technology/flask.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


<h1 id="flask">Flask</h1>
<p>Flask is a microframework in Python. It is used to create a webapp. It can start a python web server. It can handle HTTP requests. It can also be used to make a webapp API.</p>
<h2 id="flask-hello-world">Flask Hello World</h2>
<ul>
<li>
<p>Create a python file <code>main.py</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="ch">#!venv_app/bin/python3</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>    <span class="k">return</span> <span class="s2">&quot;Hello from Flask App!&quot;</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>run using <code>python main.py</code></li>
</ul>
<ul>
<li>access at <code>http://localhost:5000</code> in browser.</li>
</ul>
<h2 id="run-a-flask-app-ways">Run a Flask App - Ways</h2>
<ul>
<li>python<ul>
<li><code>python main.py</code></li>
</ul>
</li>
</ul>
<ul>
<li>executable<ul>
<li><code>chmod a+x main.py</code> to make app executable.</li>
<li><code>./main.py</code> runs app.</li>
</ul>
</li>
</ul>
<ul>
<li>Flask CLI<ul>
<li><code>flask --app main.py run</code>
  or</li>
<li><code>export FLASK_APP=main.py</code> will make an variable that tells python which app to run.</li>
<li><code>flask run</code> executes the app or if flask is not in path then do <code>python -m flask run</code></li>
</ul>
</li>
</ul>
<h2 id="flask-native-modules">Flask native modules</h2>
<p><em>flask basics, request-response handling, contexts</em></p>
<ul>
<li><strong>Application Instance</strong><ul>
<li><code>Flask()</code> - is a class.</li>
<li>All Flask applications must create an <strong>application instance</strong> (object of class <code>Flask</code>). The web server passes all requests it receives from clients to this object for handling, using a protocol called Web Server Gateway Interface (WSGI).</li>
<li><code>app = Flask(__name__)</code> name is passed to <code>Flask</code> class constructor so it knows the location of app and hence can locate static and template.</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Requests</strong><ul>
<li>Request from client has lot of information in it, like header, user-agent, data etc. This information is available in <code>request object</code> and is made available to a <code>view-route function</code> to handle it. This object is not passed as an argument to function, rather it is made available using <code>contexts</code>.</li>
<li><code>request</code> Object has methods and attributes having info on method, form, args, cookies, files, remote_addr, get_data().</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Contexts</strong><ul>
<li>Code needs data to be processed, that data can be configurations, input data or data from file/database. Context is used to keep track of this data.</li>
<li>It let certain objects to be globally accessible, but are not global variable. They are globally accessible to only one thread. There can be multiple threads serving multiple requests from multiple client.</li>
<li>Context is simply data that is specific to something. Eg<ul>
<li><strong>App-context</strong> is specific to app, like its mail server, its database location, or other configurations. Keeps track of application-level data. Objects: <code>current_app</code>, <code>g</code>.</li>
<li><strong>Request-context</strong> is specific to request, like its browser, its client, its form data, its headers, all that is request-level. Objects: <code>request</code>, <code>session</code>.</li>
</ul>
</li>
<li>this data is stored in object, in attribute such as <code>config</code></li>
<li>this data is used by extensions in flask, hence they do not run if context is not available.</li>
<li>context is automatically made available once app is initialized.</li>
<li>context can be made explicitly available by calling <code>with app.app_context():</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>Request Handling</strong><ul>
<li>
<p>when there is request, web server activates a thread that initializes app and this app context is pushed with data that is available globally, similarly request context is also pushed.</p>
<pre class="mermaid"><code>graph LR;
Web_Browser --&gt; request --&gt; web_server --&gt; Flask_app_instance --&gt; route --&gt; function_to_execute</code></pre>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Flask variables for Request Handling</strong><ul class="task-list">
<li><code>current_app</code> variable in Application context, has info of active application.</li>
<li><code>g</code> variable in Application context, it is object that is unique for each request, temp access <strong>during</strong> handling of a request. It resets once request is served. Holds app info hence app context. Can be used to load user on each request. show logged in user on templates.</li>
<li><code>request</code>, in request context, obj having client req data.</li>
<li><code>session</code>, in request context, stores data across requests, i.e., a dictionary to store values that can be accessed in different requests from same session.</li>
<li>Flask, in backend, makes these available to thread before dispatching a request and removes after request is handled. Explicitly, <code>current_app</code> can be made available by invoking <code>app.app_context()</code></li>
<li class="task-list-item"><input type="checkbox"/> How does flask differentiate requests and clients?</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Request Hooks</strong><ul>
<li>They are deocrators that register functions that can execute code before or after each request is processed. They are implemented as decorators  (functions that execute on event). These are the four hooks supported by Flask:</li>
<li><code>before_request</code> - like authenticate</li>
<li><code>before_first_request</code> - only before the first request is handled. Eg, to add server initialization tasks.</li>
<li><code>after_request</code> - after each request, but only if no unhandled exceptions occurred.</li>
<li><code>teardown_request</code> - after each request, even if unhandled exceptions occurred.</li>
<li><code>g</code> context global storage can be used to share data between hook and view functions.</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Routes or View Functions</strong><ul>
<li>They handle application URLs.</li>
<li>URL-maps can be seen using <code>app.url_map</code></li>
<li>redirect to url<ul>
<li><code>redirect</code> - takes URL to redirect to.</li>
<li><code>redirect(url_for("profile"))</code></li>
<li><code>url_for()</code> utility builds URL for view-function giving route from app-url-map. takes function name as str and gives its URL. Eg:<ul>
<li><code>url_for('user', name='john', page=2, version=1)</code> would return <code>/user/john?page=2&amp;version=1</code>, they are good to build dynamic URLs that can be used in templates.</li>
<li><code>url_for('user', name='john', _external=True)</code> would return <code>http://localhost:5000/user/john</code>.</li>
<li><code>url_for('static', filename='css/styles.css', _external=True)</code> would return <code>http://localhost:5000/static/css/styles.css</code>.</li>
<li><code>/static/&lt;filename&gt;</code> is special route added by Flask to serve static files.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Response Object</strong></p>
<ul>
<li>
<p>Response is returned by view-function as a string (usually HTML) along with <strong>status code</strong> but can also contain <strong>headers</strong>. So rather than sending comma separated tuple values, flask lets create response object using <code>make_response()</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">make_response</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">make_response</span><span class="p">(</span><span class="s1">&#39;&lt;h1&gt;Some response with a cookie!&lt;/h1&gt;&#39;</span><span class="p">)</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="n">response</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">,</span> <span class="s1">&#39;51&#39;</span><span class="p">)</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="k">return</span> <span class="n">response</span>
</code></pre></div>
</li>
</ul>
<ul>
<li><code>return redirect('http://www.example.com')</code> is a response with URL and status code 302, however Flask lets it do easily using <code>redirect()</code> method. Another such is <code>abort(404)</code> which is treated as exception.</li>
</ul>
<ul>
<li><strong>session</strong> - can be used to store values, specific to current session, it is server side. Helps to pass values from one function to another.<ul>
<li><code>session["username"] = username</code></li>
<li>permanent sessions store session data for a time period</li>
</ul>
</li>
</ul>
<ul>
<li><strong>flash</strong> - lets send extra messages to frontend<ul>
<li><code>flash("The message", "info")</code> message and level.</li>
<li><code>get_flashed_messages()</code> to get messages</li>
<li>it lets record a message at the end of a request and access it next request and only next request.<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>{% for message in get_flashed_messages() %}
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;flash&quot;</span><span class="p">&gt;</span>{{ message }}<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>{% endfor %}
</code></pre></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="templates-in-flask">Templates in Flask</h2>
<p>Templates can be used to build responses.</p>
<ul>
<li><strong>render_template()</strong><ul>
<li>it makes use of template</li>
<li><code>return render_template('user.html', name=name)</code></li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Jinja Templates</strong></p>
<ul>
<li>Templates are HTML file having additional Python like code in <strong>placeholders</strong>.</li>
<li>Placeholders can have <strong>variables</strong> and <strong>expressions</strong>.</li>
<li>They get replaced with value when template is rendered by <strong>JinJa2</strong>, the template engine.</li>
<li>This lets build dynamic content on execution.</li>
<li>It lets <strong>inherit</strong>, <strong>extend</strong> and <strong>import</strong> templates.</li>
<li>More documentation on <a href="https://jinja.palletsprojects.com/en/latest/templates/">template design</a> and <a href="https://jinja.palletsprojects.com/en/latest/tricks/">tips and tricks</a></li>
<li>
<p>Example template is below.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="cp">&lt;!DOCTYPE html&gt;</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&quot;en&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>My Webpage<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>    <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;navigation&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>    {% for item in navigation %}
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>        <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;{{ item.href }}&quot;</span><span class="p">&gt;</span>{{ item.caption }}<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    {% endfor %}
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>    <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    {% if kenny.sick %}
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>      Kenny is sick.
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>    {% elif kenny.dead %}
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>      You killed Kenny!  You bastard!!!
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>    {% else %}
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>      Kenny looks okay --- so far
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>    {% endif %}
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>    <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>My Webpage<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>    {{ a_variable }}
<a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>
<a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>    {# a comment #}
<a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a><span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a><span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
</li>
</ul>
<ul>
<li><strong>Filters</strong><ul>
<li>pass value over pipe to filter functions like upper, lower, title, trim, safe.</li>
<li>eg, <code>Hello, {{ name|capitalize }}</code></li>
<li>Full list of filters <a href="https://jinja.palletsprojects.com/en/latest/templates/#list-of-builtin-filters">here</a></li>
</ul>
</li>
</ul>
<ul>
<li><strong>Delimiters</strong><ul>
<li>{% ... %} for Statements</li>
<li>{{ ... }} for Expressions to print</li>
<li>{# ... #} for Comments, not included in the template output.</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Assignments</strong><ul>
<li>
<p>lets set a value to var and use it for logic building. We have to use namespace.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>{% set ns = namespace(index=0) %}
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>{% for nav_item in nav %} 
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>  {% if ns.index !=0 %}
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    --- some stuff ---
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>  {% endif %}
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>  {% set ns.index = ns.index + 1 %}
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>{% endfor %}
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>{{ super() }}, includes code from parent block, if overriding a block.</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Error Handlers</strong><ul>
<li>
<p><code>@app.errorhandler</code> is decorator that lets return a view from template for error responses like 404 and 500.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nd">@app</span><span class="o">.</span><span class="n">errorhandler</span><span class="p">(</span><span class="mi">404</span><span class="p">)</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="k">def</span> <span class="nf">page_not_found</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;404.html&#39;</span><span class="p">),</span> <span class="mi">404</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="nd">@app</span><span class="o">.</span><span class="n">errorhandler</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="k">def</span> <span class="nf">internal_server_error</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;500.html&#39;</span><span class="p">),</span> <span class="mi">500</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<h2 id="flask-extensions">Flask Extensions</h2>
<p>Most extensions use app context to initialize themselves, eg:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span> <span class="nn">flask_bootstrap</span> <span class="kn">import</span> <span class="n">Bootstrap</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">bootstrap</span> <span class="o">=</span> <span class="n">Bootstrap</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</code></pre></div>
<h3 id="bootstrap-in-flask">Bootstrap in Flask</h3>
<ul>
<li>
<p><strong>Bootstrap</strong> - provides templates and blocks that can be used in Jinja2 Templates</p>
<ul>
<li>installation <code>pip install flask-bootstrap</code></li>
<li>eg, <code>{% extends "bootstrap/base.html" %}</code> - base.html does not exist but is available via extension. Others are <code>navbar</code>, <code>content</code>, <code>script</code></li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>{% block scripts %}
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>{{ super() }} <span class="cm">&lt;!--includes base scripts too, else overrides--&gt;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="p">&lt;</span><span class="nt">script</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;my-script.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>{% endblock %}
</code></pre></div>
</li>
</ul>
<h3 id="moment-js-in-flask">Moment JS in Flask</h3>
<ul>
<li><strong>Moment.js Flask-Moment</strong> - Localization of Dates and Times<ul>
<li>server should send UTC, client should present in local time and formatted to region using JavaScript.</li>
<li><code>Moment.js</code> is perfect for this and is available as flask extension. It can be used in Jinja2 template.</li>
<li><code>pip install flask-moment</code></li>
<li>
<p>include the script, <code>jQuery</code> is already attached as part of bootstrap</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>{% block scripts %}
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>  {{ super() }}
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>  {{ moment.include_moment() }}
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>{% endblock %}
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">from</span> <span class="nn">flask_moment</span> <span class="kn">import</span> <span class="n">Moment</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">moment</span> <span class="o">=</span> <span class="n">Moment</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="k">return</span> <span class="n">moment</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">())</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;LLL&#39;</span><span class="p">)</span> <span class="c1"># local time</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="k">return</span> <span class="n">moment</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">())</span><span class="o">.</span><span class="n">fromNow</span><span class="p">(</span><span class="n">refresh</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># a few seconds ago..</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<h2 id="forms-in-flask">Forms in Flask</h2>
<ul>
<li>
<p><strong>WTForms</strong> - <strong>Object Oriented</strong> Form building, rendering and validations.</p>
<ul>
<li>supports forms validation, CSRF protection, internationalization (I18N), rendering form and more for any Python framework, its generic. <a href="http://wtforms.simplecodes.com/">WTForms</a>.</li>
<li>Cons - It lets you build form in python and help validate it. It adds a extra learning curve than using HTML for the same. It same as ORM that you define things as class variables.</li>
<li>You have to build a template but can use <code>Form.field</code></li>
<li>It lets you extend forms.</li>
<li>lets you show error easily without using <code>flash</code>.</li>
</ul>
<ul>
<li>
<p><strong>Model Building</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">from</span> <span class="nn">wtforms</span> <span class="kn">import</span> <span class="n">Form</span><span class="p">,</span> <span class="n">BooleanField</span><span class="p">,</span> <span class="n">StringField</span><span class="p">,</span> <span class="n">validators</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="k">class</span> <span class="nc">RegistrationForm</span><span class="p">(</span><span class="n">Form</span><span class="p">):</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>  <span class="n">username</span>     <span class="o">=</span> <span class="n">StringField</span><span class="p">(</span><span class="s1">&#39;Username&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">validators</span><span class="o">.</span><span class="n">Length</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">25</span><span class="p">)])</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>  <span class="n">email</span>        <span class="o">=</span> <span class="n">StringField</span><span class="p">(</span><span class="s1">&#39;Email Address&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">validators</span><span class="o">.</span><span class="n">Length</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">35</span><span class="p">)])</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>  <span class="n">accept_rules</span> <span class="o">=</span> <span class="n">BooleanField</span><span class="p">(</span><span class="s1">&#39;I accept the site rules&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">validators</span><span class="o">.</span><span class="n">InputRequired</span><span class="p">()])</span>
</code></pre></div>
<ul>
<li>Form Class - in main <code>app.py</code> or in module <code>forms.py</code> make class with fields and validate functions.</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Flask-WTF</strong> integration of Flask and WTForms</p>
<ul>
<li>Includes CSRF, file upload, and reCAPTCHA. You mostly have to use formats of WTForms but write less as few things are done automatically that are related to Flask patter.</li>
<li>Form fields are Class variables with different field type</li>
<li>validator functions can help validate, like <code>Email()</code>.</li>
<li>Link to <a href="http://pythonhosted.org/Flask-WTF/">Flask-WTF</a></li>
</ul>
<ul>
<li>
<p><strong>Validation &amp; Prefill</strong> controller</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">session</span><span class="p">,</span> <span class="n">redirect</span><span class="p">,</span> <span class="n">url_for</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>  <span class="n">form</span> <span class="o">=</span> <span class="n">NameForm</span><span class="p">()</span> <span class="c1"># defined as OOP model</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>  <span class="k">if</span> <span class="n">form</span><span class="o">.</span><span class="n">validate_on_submit</span><span class="p">():</span> <span class="c1"># cheks POST and validates</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="n">session</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">data</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span> <span class="c1"># POST -&gt; back to this function as GET</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>  <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="n">form</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">))</span> <span class="c1"># When GET</span>
</code></pre></div>
<ul>
<li>Route - define new route, import form class and use. On submit, create object of model class to save/query data.</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Rendering</strong> view</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="p">&lt;</span><span class="nt">form</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;POST&quot;</span><span class="p">&gt;</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>{{ form.hidden_tag() }}
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>{{ form.name.label }} {{ form.name() }}
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>{{ form.submit() }}
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</code></pre></div>
<ul>
<li>HTML template - in <code>templates</code> folder, rendered from route with form passed as data. Display form elements, errors and hidden_tag.</li>
</ul>
<ul>
<li>
<p>You can use <strong>bootstrap</strong> and flask-wtf combine to avoid writing template code and just use</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>{% import &quot;bootstrap/wtf.html&quot; as wtf %}
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>{{ wtf.quick_form(form) }}
</code></pre></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="databases-in-flask">Databases in Flask</h2>
<p>DB_package or ORM - Python has packages for most database engines like MySQL, Postgres, SQLite, MongoDb etc. If not, you can use ORM that lets you use Python objects to do SQL operations, SQLAlchemy or MongoEngine are such packages.</p>
<ul>
<li>
<p><a href="http://pythonhosted.org/Flask-SQLAlchemy/">Flask-SQLAlchemy</a> is wrapper on <a href="http://www.sqlalchemy.org/">SQLAlchemy</a>. You have to use SQLAlchemy pattern but it helps by making things tied to Flask way like session of SQLAlchemy is tied to web-request of flask.</p>
<ul>
<li>It is an design for Flask that adds support for SQLAlchemy to your application.</li>
<li>You can define table as a class, called model, with member variables as column names.</li>
</ul>
<ul>
<li><strong>Installation</strong> <code>pip install flask-sqlalchemy</code></li>
</ul>
<ul>
<li>
<p><strong>Initiation</strong></p>
<ul>
<li>create <code>SQLAlchemy()</code> class object and pass <code>app</code> for context.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">from</span> <span class="nn">flask_sqlalchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemy</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;SQLALCHEMY_DATABASE_URI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;sqlite:///&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">basedir</span><span class="p">,</span> <span class="s1">&#39;data.sqlite&#39;</span><span class="p">)</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;SQLALCHEMY_TRACK_MODIFICATIONS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">(</span><span class="n">app</span><span class="p">)</span> <span class="c1"># Object for all ops</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="n">__tablename__</span> <span class="o">=</span> <span class="s1">&#39;users&#39;</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="nb">id</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="n">username</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="n">admin</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">Boolean</span><span class="p">)</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="n">created_on</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">DateTime</span><span class="p">(),</span> <span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="n">updated_at</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">DateTime</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">,</span> <span class="n">onupdate</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>     <span class="c1"># insert new record to database</span>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a><span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>  <span class="c1"># delete a record from database</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>     <span class="c1"># updates modifications in object if any</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>
<a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a><span class="c1"># where clause</span>
<a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter_by</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;username&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">first</span><span class="p">()</span> <span class="c1"># or .all()</span>
<a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a>
<a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="c1"># select * from users</span>
<a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="n">users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p><strong>DB Model</strong></p>
<ul>
<li>It is a Class which represents application entities, like, User, Task, Author, Book etc.</li>
<li>We can define, table, its columns, data types, keys and relationships.</li>
<li><code>__tablename__ = 'users'</code></li>
<li>It has attributes that represent column name. <code>name = db.Column(db.String(64), unique=True)</code></li>
</ul>
<ul>
<li><strong>Relationships</strong> To create ER in OOPs way <code>users = db.relationship('User', backref='role')</code><ul>
<li><code>backref</code> adds a back-reference to other models</li>
<li><code>lazy</code> does not execute until you add executor.<ul>
<li>add <code>lazy='dynamic'</code> to prevent query execution.</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Create</strong></p>
<ul>
<li>Once you have created a db model in flask app, you can create db and tables using following steps:<ul>
<li><code>python</code></li>
<li><code>from main import db</code> main is filename of flask app</li>
<li><code>db.create_all()</code> creates all tables from model class, if they don't exist</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>Now you can check SQL for tables created. You can do:</p>
<ul>
<li><code>sqlite3 filename.db</code></li>
<li><code>.tables</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Insert</strong> a new row<ul>
<li>Create an Object of Class to build a new row. <code>user_john = User(username='john', role=admin_role)</code></li>
<li>add - <code>db.session.add(user_john)</code></li>
<li><code>id</code> is added to object after <code>db.session.commit()commit()</code></li>
</ul>
</li>
<li><strong>Update</strong> - <code>db.session.add()</code> also edits.</li>
<li><strong>Delete</strong> - <code>db.session.delete(obj_name)</code></li>
<li><strong>Read</strong> - <code>query</code> object is available to all model class. It has filter-options and executors that build a SQL Query statement.<ul>
<li>Filter-Options - <code>filter()</code>, <code>filter_by()</code>, <code>limit()</code>, <code>offset()</code>, <code>order_by()</code>, <code>group_by()</code></li>
<li>Executors - <code>all()</code>, <code>first()</code>, <code>first_or_404()</code>, <code>get()</code>, <code>get_or_404()</code>, <code>count()</code>, <code>paginate()</code></li>
<li>Examples<ul>
<li><code>User.query.all()</code> reads all records</li>
<li><code>User.query.filter_by(role=user_role).all()</code></li>
</ul>
</li>
<li><code>str(User.query.filter_by(role=user_role))</code> returns SQL query</li>
</ul>
</li>
</ul>
<ul>
<li><strong>RAW SQL</strong> - give your SQL statements<ul>
<li><code>db.session.execute(SQL)</code> returns cursor</li>
<li><code>db.session.execute(SQL).all()</code> - returns List result set</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Shell Operations</strong> - CRUD from Flask Shell<ul>
<li><code>flask --app hello.py shell</code> start shell with <em>app_context</em>, python shell will not have that.</li>
<li><code>db.cratte_all()</code> creates SQLite file.</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Py ORM Model from SQL</strong><ul>
<li>Generate SQLAlchemy class model from database table - <code>sqlacodegen mssql+pyodbc://&lt;servername&gt;\&lt;schema&gt;/&lt;database&gt;/&lt;table_name&gt;?driver=SQL+Server --outfile db.py</code></li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Migrations</strong> DB changes version controlled</p>
<ul>
<li><strong>Why?</strong> - When DB is handled using ORM, all changes to DB is done via ORM. If you have to add a column it is added by ORM so it will delete the table and create new but to prevent data loss in table it will create a migration script to create and populate again.</li>
</ul>
<ul>
<li><strong>What?</strong> - <code>Flask-Migrate</code> is wrapper on <code>Alembic</code> a SQLAlchemy migration framework. It generates Py script to keep the database schema updated with the models defined. It help upgrade and roll back the schemas.</li>
</ul>
<ul>
<li><strong>Installation</strong> - <code>pip install flask-migrate</code></li>
</ul>
<ul>
<li><strong>Initiation</strong><ul>
<li><code>from flask_migrate import Migrate</code></li>
<li><code>migrate = Migrate(app, db)</code></li>
<li><code>flask --app hello.py db init</code> migration directory, script is generated</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Execution</strong><ul>
<li><code>upgrade()</code> has data changes to be done in this migration</li>
<li><code>downgrade()</code> rolls back to previous state</li>
<li>Example: Steps to make a migration<ul>
<li>Make changes to model classes</li>
<li><code>flask --app hello.py db migrate -m "initial migration"</code> to generate script</li>
<li>review for accurate changes. add to source control</li>
<li><code>flask--app hello.py db upgrade</code> to do migration in database</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Reference</strong><ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-make-a-web-application-using-flask-in-python-3">How To Make a Web Application Using Flask in Python 3</a></li>
<li><a href="https://sqlitebrowser.org/">SQLite explorer</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="emails-in-flask">Emails in Flask</h2>
<ul>
<li><strong>Why</strong> password reset, confirmations</li>
</ul>
<ul>
<li><strong>How?</strong><ul>
<li>Emails can be sent using <code>smtplib</code> package from Python standard library.</li>
<li>Email is sent by <strong>connecting</strong> to <strong>SMTP Server</strong> which takes request to send email to recipient.</li>
<li><strong>Localhost</strong> on <strong>port 25</strong> is local server that can send email.</li>
<li><strong>External</strong> SMTP server like <code>mail.googlemail.com</code> on <code>587</code> port can be used to send emails through <strong>Google Gmail</strong> account.</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Flask-Mail</strong> is a extension that wraps <code>smtplib</code><ul>
<li><strong>Installation</strong> <code>pip install flask-mail</code></li>
<li><strong>import</strong> <code>from flask_mail import Mail, Message</code></li>
<li><strong>instantiate</strong> and initialize <code>mail = Mail(app)</code></li>
<li><strong>build</strong> obj <code>msg_obj = Message('sub','sender','to')</code></li>
<li><strong>add body</strong> and html to obj, may use template for it <code>msg.body = render_template(template + '.txt', **kwargs)</code></li>
<li><strong>send</strong> <code>mail.send(msg_obj)</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>Sending Asynchronous Email</strong><ul>
<li>Message() object can be build in mail python file but Mail() object, which sends the email using msg_obj, should run in separate thread to avoid lags.</li>
<li>use python Thread() class from <strong>threading</strong> package to make new thread that runs the send_async_email(app,msg) functions. this functions has<ul>
<li>app object of FLask() for context</li>
<li>msg object of Message() for content</li>
<li>uses mail object of Mail() to send.</li>
</ul>
</li>
<li><code>from threading import Thread</code></li>
<li>The function which build Message(), add line<ul>
<li><code>thr = Thread(target=send_async_email, args=[app, msg])</code> - build thread obj</li>
<li><code>thr.start()</code> execute thread separately</li>
<li><code>return thr</code> [ ] why this is added</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Local Email Server</strong><ul>
<li><code>(venv) $ python -m smtpd -n -c DebuggingServer localhost:8025</code> this command starts emulated email server.</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Variables</strong> that we might need to <strong>export</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nb">export</span><span class="w"> </span><span class="nv">MAIL_SERVER</span><span class="o">=</span>smtp.googlemail.com
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="nb">export</span><span class="w"> </span><span class="nv">MAIL_PORT</span><span class="o">=</span><span class="m">587</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">MAIL_USE_TLS</span><span class="o">=</span><span class="m">1</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="nb">export</span><span class="w"> </span><span class="nv">MAIL_USERNAME</span><span class="o">=</span>email_id@domain.com
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">MAIL_PASSWORD</span><span class="o">=</span><span class="s2">&quot;password&quot;</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p><strong>Sending errors via Email</strong></p>
<ul>
<li>Errors can be sent via email using Logs.</li>
</ul>
<ul>
<li>Links<ul>
<li><a href="https://flask.palletsprojects.com/en/2.2.x/logging/#email-errors-to-admins">Flask docs - Email errors to admin</a></li>
<li><a href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy#:~:text=of%20the%20application.-,Sending%20errors%20via%20email,-To%20address%20our">MG's microblog - email errors</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="blueprint-large-app-structure-in-flask">Blueprint - Large App Structure in Flask</h2>
<p><em>needs improvements after hands-on</em></p>
<ul>
<li>simply, module is file, package is folder. Blueprint can be implemented in both.</li>
</ul>
<ul>
<li><strong>single module</strong> - <a href="https://github.com/mjhea0/flask-tracking/tree/part-0">link</a><ul>
<li>
<p>here, one file has everything defined</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>/prj
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span>my-app.py<span class="w"> </span><span class="c1"># imports, app, db, orm_class, form_class, route_view_functions, run</span>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">    </span>/static
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">    </span>/templates
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox"/> no package, Blueprints as modules?</li>
</ul>
<ul>
<li><strong>single package</strong>, Blueprints as modules - <a href="https://github.com/mjhea0/flask-tracking/tree/part-1">link</a><ul>
<li>here all ORM &amp; FORM classes are in one module</li>
<li>
<p>more complex, app-factory, no ORM, installable example with same structure, <a href="https://github.com/pallets/flask/tree/main/examples/tutorial">here</a></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>/prj
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">    </span>run.py<span class="w">          </span><span class="c1"># import app, db. then run. What parts to run?</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">    </span>config.py<span class="w">       </span><span class="c1"># module. config vars. With which configurations?</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">    </span>/my-app<span class="w">         </span><span class="c1"># package</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">        </span>__init__.py<span class="w"> </span><span class="c1"># app, register BP</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">        </span>forms.py<span class="w">    </span><span class="c1"># module. has form classes</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="w">        </span>models.py<span class="w">   </span><span class="c1"># module. DB setup. has ORM classes.</span>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="w">        </span>auth.py<span class="w">     </span><span class="c1"># module BP. import db, form, model. route-view-functions. login, register, logout. @login_required.</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="w">        </span>blog.py<span class="w">     </span><span class="c1"># module BP. import db, form, model. route-view-functions. CRUD.</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a><span class="w">        </span>/template
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a><span class="w">        </span>/static
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>multi-packages</strong>, Blueprints as sub-packages - <a href="https://github.com/mjhea0/flask-tracking/tree/part-2">link</a><ul>
<li>here ORM &amp; FORM classes are in separate module for each Blueprint.</li>
<li>DB is top-level as it is shared by all sub-packages</li>
<li>
<p>auth is top-level to avoid circular dependencies.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>/prj
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">    </span>run.py<span class="w">              </span><span class="c1"># same. import app, db. then run</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span>config.py<span class="w">           </span><span class="c1"># same. module. config vars</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">    </span>/my-app<span class="w">             </span><span class="c1"># package</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">        </span>__init__.py<span class="w">     </span><span class="c1"># app, register BP</span>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">        </span>auth.py<span class="w">         </span><span class="c1"># login init. login_manager</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">        </span>data.py<span class="w">         </span><span class="c1"># db setup, init, open, close. crud helpers</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">        </span>/users
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">            </span>__init__.py<span class="w"> </span><span class="c1"># blank</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">            </span>forms.py<span class="w">    </span><span class="c1"># module. has form classes. LoginForm, RegisterForm</span>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">            </span>models.py<span class="w">   </span><span class="c1"># module. has ORM classes. User.</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="w">            </span>views.py<span class="w">    </span><span class="c1"># BP Module. imports form, model. defines route-view-functions</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="w">        </span>/blog
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="w">            </span>__init__.py<span class="w"> </span><span class="c1"># blank</span>
<a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="w">            </span>forms.py<span class="w">    </span><span class="c1"># module. has form classes. CreateBlogForm, EditBlogForm</span>
<a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="w">            </span>models.py<span class="w">   </span><span class="c1"># module. has ORM classes. Post, Follower.</span>
<a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="w">            </span>views.py<span class="w">    </span><span class="c1"># BP Module. imports form, model. defines route-view-functions</span>
<a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a><span class="w">            </span>geodata.py<span class="w">  </span><span class="c1"># module. helper functions.</span>
<a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>
<a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a><span class="w">        </span>/template
<a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a><span class="w">        </span>/static
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>Example - <a href="https://github.com/miguelgrinberg/flasky">Miguel Grinbers's Flasky</a><ul>
<li>app-factory using <code>create_app()</code> in init.</li>
<li>models are all in one module, not in blueprint package. [ ] why? probably all BP use models</li>
<li>blueprint as sub-package's <code>__init__.py</code>, not views. [ ] why?</li>
<li>
<p>api package has multiple modules, all have route-view-functions.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>prj/
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">    </span>run.py<span class="w">      </span><span class="c1"># imports create_app, db, ORM-models. app init. flasky.py</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span>config.py<span class="w">   </span><span class="c1"># module. config class with vars. EnvDict</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">    </span>/app
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">        </span>__init__.py<span class="w"> </span><span class="c1"># import config, extensions. add extensions. def create_app.</span>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">        </span>models.py<span class="w">   </span><span class="c1"># import db, login_manager. def all ORM and Mixin classes</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">        </span>/auth
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">            </span>__init.py<span class="w"> </span><span class="c1"># define BP. import views</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="w">            </span>forms.py<span class="w">  </span><span class="c1"># import ORM. Form classes</span>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">            </span>views.py<span class="w">  </span><span class="c1"># import db, Forms, ORMs. def route-view-functions login, logout, register, reset</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">        </span>/main
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="w">            </span>__init.py<span class="w"> </span><span class="c1"># define BP. import routes</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="w">            </span>forms.py<span class="w">  </span><span class="c1"># import ORM. Form classes</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="w">            </span>views.py<span class="w">  </span><span class="c1"># import db, Forms, ORMs. def route-view-functions</span>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="w">        </span>/api
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="w">            </span>__init.py<span class="w">         </span><span class="c1"># define BP. import each routes</span>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="w">            </span>authentication.py<span class="w"> </span><span class="c1"># import ORM, api. def route-view-functions tokens</span>
<a id="__codelineno-19-19" name="__codelineno-19-19" href="#__codelineno-19-19"></a><span class="w">            </span>comments.py<span class="w">       </span><span class="c1"># import db, ORM, api. def route-view-functions tokens</span>
<a id="__codelineno-19-20" name="__codelineno-19-20" href="#__codelineno-19-20"></a><span class="w">            </span>posts.py<span class="w">          </span><span class="c1"># import db, ORM, api. def route-view-functions tokens</span>
<a id="__codelineno-19-21" name="__codelineno-19-21" href="#__codelineno-19-21"></a><span class="w">            </span>users.py<span class="w">          </span><span class="c1"># import ORMs, api. def route-view-functions users, follower</span>
<a id="__codelineno-19-22" name="__codelineno-19-22" href="#__codelineno-19-22"></a><span class="w">        </span>/static
<a id="__codelineno-19-23" name="__codelineno-19-23" href="#__codelineno-19-23"></a><span class="w">        </span>/templates
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>Example - <a href="https://github.com/miguelgrinberg/microblog">Miguel Grinbers's microblog</a><ul>
<li>same as above, flasky</li>
<li>
<p>in sub-packages, views.py is routes.py</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>prj/
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">    </span>run.py<span class="w">      </span><span class="c1"># imports create_app, db, ORM-models. app init.</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span>config.py<span class="w">   </span><span class="c1"># module. config class with vars</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">    </span>/app
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">        </span>__init__.py<span class="w"> </span><span class="c1"># import config. add extensions. def create_app. import models.</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">        </span>models.py<span class="w">   </span><span class="c1"># all ORM and Mixin classes</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">        </span>/auth
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">            </span>__init.py<span class="w"> </span><span class="c1"># define BP. import routes</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">            </span>forms.py<span class="w">  </span><span class="c1"># import ORM. Form classes</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">            </span>routes.py<span class="w"> </span><span class="c1"># import db, bp, Forms, ORMs. def route-view-functions login, logout, register, reset</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">        </span>/main
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">            </span>__init.py<span class="w"> </span><span class="c1"># define BP. import routes</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">            </span>forms.py<span class="w">  </span><span class="c1"># import ORM. Form classes</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="w">            </span>routes.py<span class="w"> </span><span class="c1"># import db, bp, Forms, ORMs. def route-view-functions</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="w">        </span>/api
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="w">            </span>__init.py<span class="w"> </span><span class="c1"># define BP. import routes</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">            </span>tokens.py<span class="w"> </span><span class="c1"># import db, bp. def route-view-functions tokens</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">            </span>users.py<span class="w">  </span><span class="c1"># import db, bp, ORMs. def route-view-functions users, follower</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="w">        </span>/static
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="w">        </span>/templates
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>Example - <a href="https://github.com/miguelgrinberg/microblog-api">Miguel Grinbers's microblog-api</a><ul>
<li>app-factory using create_app in app.py</li>
<li>Blueprints as modules</li>
<li>
<p>single package</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>/prj
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">    </span>run.py
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">    </span>config.py
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span>api/
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">        </span>__init__.py<span class="w"> </span><span class="c1"># imports create_app, db</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">        </span>app.py<span class="w">      </span><span class="c1"># create_app, db init, registers BP</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">        </span>auth.py<span class="w">     </span><span class="c1"># import db, model. login functions</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">        </span>models.py<span class="w">   </span><span class="c1"># import db. ORM classes</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">        </span>posts.py<span class="w">    </span><span class="c1"># BP. imports db, ORM. route-view-functions posts, feed</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">        </span>tokens.py<span class="w">   </span><span class="c1"># BP. imports db, ORM. route-view-functions tokens, reset_token</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a><span class="w">        </span>users.py<span class="w">    </span><span class="c1"># BP. imports db, ORM. route-view-functions users, me, followers</span>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="w">        </span>templates/<span class="w">  </span><span class="c1"># only email reset html</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>Example - <a href="https://github.com/miguelgrinberg/microblog-2012">Miguel Grinbers's microblog-2012</a><ul>
<li>separate module for model, form, email and view.</li>
<li>no blueprint, no app-factory, no sub-package</li>
</ul>
</li>
</ul>
<ul>
<li>what looks good - why?<ul>
<li>app-factory - gives flexibility</li>
<li>config - for env separation<ul>
<li>use config class for defaults and different envs</li>
<li>use YAML file to read secrets and keep it out of git</li>
<li><a href="https://flask.palletsprojects.com/en/2.2.x/config/#configuration-best-practices">more on config best practice</a></li>
</ul>
</li>
<li>blueprints as modules.</li>
<li>links<ul>
<li><a href="https://hackersandslackers.com/configure-flask-applications/">Another good tutorial</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Why?</strong> - App needs to be structured into modules as it starts growing. It also helps reuse modules.</li>
</ul>
<ul>
<li>
<p><strong>Without Blueprint</strong></p>
<ul>
<li><strong>Single py file</strong> app structure<ul>
<li><strong>import</strong> flask modules and extensions</li>
<li><strong>instantiate</strong> flask app <code>app = Flask(__name__)</code></li>
<li><strong>configure</strong> app with all configs, eg, <code>app.config['MAIL_PORT'] = 587</code></li>
<li><strong>initialize</strong> extensions, eg, <code>mail = Mail(app)</code>. Not all extensions are initialized, eg, FlaskForm</li>
<li>DB <strong>ORM</strong> Classes</li>
<li><strong>Email</strong> functions - may use templates</li>
<li><strong>Form</strong> Classes</li>
<li><strong>error</strong> handlers functions - may use templates</li>
<li><strong>routes</strong>, they may use use<ul>
<li>above extensions, eg - checks Form, sends email, writes to db, or returns an error</li>
<li>native - session, flash, g</li>
<li><strong>templates</strong>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>templates</strong> and <strong>static</strong> files structure<ul>
<li>base template is HTML, it has blocks. Block-content can be replaced or appended</li>
<li>base-template is used to build different pages which put dynamic content in blocks.</li>
<li>static files can be used from static folder.</li>
<li>example flow<ul>
<li><code>base.html</code> has blocks, title, nav, page_content</li>
<li>index or profile have <code>{% extends "base.html" %}</code>, it tells Jinja to use base.</li>
<li>block-content can be replaced or appended using <code>{{ super() }}</code></li>
<li>files from <code>static</code> folder using <code>{{ url_for('static', 'favicon.ico') }}</code></li>
<li>external packages can be imported as py_var to build content as py_var and use in content. eg - wtf template can be imported from bootstrap to build content from form_object using <code>{{ wtf.quick_form(form) }}</code>.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Blueprint</strong> lets us divide app into mini apps. It is a collection of views, templates, static files that can be applied to an application. Blueprints are a great way to organize your application.</li>
</ul>
<ul>
<li><strong>Application Factory</strong> is way of initializing app<ul>
<li>to serve a request, when single file app in invoked, app gets initialized with configs to serve the request. You do not have flexibility to make changes to config dynamically</li>
<li>app initialization can be delayed (or controlled) by making a function to do it, called <code>factory function</code>. This can be explicitly controlled.</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>How?</strong></p>
<ul>
<li>choice - you can simply keep templates and static in one folder or can split them too and keep in blueprint sub-folders.</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>single file</strong> split</p>
<ul>
<li>in single file, you can move view-routes-functions.</li>
<li>
<p>in <code>second.py</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">second</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s2">&quot;second&quot;</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="nd">@second</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/home&quot;</span><span class="p">)</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a>    <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;from second&quot;</span><span class="p">)</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>and in <code>app.py</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="kn">from</span> <span class="nn">second</span> <span class="kn">import</span> <span class="n">second</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">second</span><span class="p">,</span> <span class="n">url_prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="k">def</span> <span class="nf">home</span><span class="p">():</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>    <span class="k">return</span> <span class="s2">&quot;Hi&quot;</span>
<a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>
<a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>multiple files</strong> split</p>
<ul>
<li>make a sub-folder and add<ul>
<li>constructor</li>
<li>error-route functions</li>
<li>form classes</li>
<li>views-route functions</li>
</ul>
</li>
<li>
<p>db models and other functions still remain in main file.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="o">|-</span><span class="n">app_name</span>      <span class="c1"># 0 top level dir - any name</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>  <span class="o">|-</span><span class="n">app</span><span class="o">/</span>          <span class="c1"># 2 package having flask application</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    <span class="o">|-</span><span class="n">templates</span><span class="o">/</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>    <span class="o">|-</span><span class="n">static</span><span class="o">/</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>    <span class="o">|-</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>   <span class="c1"># 2.1 app pkg constructor, factory</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>    <span class="o">|-</span><span class="n">models</span><span class="o">.</span><span class="n">py</span>     <span class="c1"># 2.2 db models</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>    <span class="o">|-</span><span class="n">email</span><span class="o">.</span><span class="n">py</span>      <span class="c1"># 2.3 email </span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>    <span class="o">|-</span><span class="n">main</span><span class="o">/</span>         <span class="c1"># 5 BP sub pkg</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>      <span class="o">|-</span><span class="fm">__init__</span><span class="o">.</span><span class="n">py</span>   <span class="c1"># 5.1 pkg const defines BP</span>
<a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>      <span class="o">|-</span><span class="n">errors</span><span class="o">.</span><span class="n">py</span>     <span class="c1"># 5.2 err handlers</span>
<a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a>      <span class="o">|-</span><span class="n">forms</span><span class="o">.</span><span class="n">py</span>      <span class="c1"># 5.3 form classes</span>
<a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a>      <span class="o">|-</span><span class="n">views</span><span class="o">.</span><span class="n">py</span>      <span class="c1"># 5.4 routes functions</span>
<a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>  <span class="o">|-</span><span class="n">config</span><span class="o">.</span><span class="n">py</span>     <span class="c1"># 3 configuration variables as OOPs</span>
<a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>  <span class="o">|-</span><span class="n">flasky</span><span class="o">.</span><span class="n">py</span>     <span class="c1"># 4 factory is invoked</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>3 - <code>config.py</code> config as OOPs<ul>
<li>the config variables like secret-key and mail-server, are now attributes of <code>Config</code> class.</li>
<li><code>Config</code> class has <code>@staticmethod</code> as <code>init_app(app)</code> which can be used to do things once app is available, i.e. initialize app and more.</li>
<li>This Config base class has common vars but can be extended to build different environment classes like dev, test, prod. that can have env specific vars like dev db-location.</li>
<li>add a dictionary <code>conf_env</code> to pick the correct env class.</li>
</ul>
</li>
<li>2 - <code>app/</code> App Package<ul>
<li>dir having code, template and static files.</li>
<li>2.1 - <code>app/__init__.py</code> App Pkg Constructor<ul>
<li>this is where we build the <code>factory function</code> to initialize app explicitly and controlled.</li>
<li>import Flask modules (only Flask)</li>
<li>import Flask-Extensions (only those that need app init)</li>
<li>instantiate extensions without <code>app</code></li>
<li>factory function <code>def create_app(conf_env):</code> function to have<ul>
<li>arg <code>conf_env</code> is dictionary key name (str) to pick required Env_Config_Class from <code>config.py</code> so that we have correct config vars.</li>
<li>instantiate app</li>
<li>add configs from object <code>app.config.from_object()</code></li>
<li>add configs to extensions using <code>ext_obj.init_app(app)</code></li>
<li>return app</li>
</ul>
</li>
<li>while this makes config available in controlled way, however, it missing <code>@app.routes()</code> and other decorators associated to <code>@app</code> like error handles. This is handled using <code>Blueprint</code>.</li>
<li>
<p>import BP file and register it with app using <code>register_blueprint()</code> method. When a blueprint is registered, any view functions, templates, static files, error handlers, etc. are <strong>connected</strong> to the application.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="kn">from</span> <span class="nn">flask_bootstrap</span> <span class="kn">import</span> <span class="n">Bootstrap</span>
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="kn">from</span> <span class="nn">flask_sqlalchemy</span> <span class="kn">import</span> <span class="n">SQLAlchemy</span>
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="kn">from</span> <span class="nn">config</span> <span class="kn">import</span> <span class="n">config</span>
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a><span class="n">bootstrap</span> <span class="o">=</span> <span class="n">Bootstrap</span><span class="p">()</span>
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a><span class="n">db</span> <span class="o">=</span> <span class="n">SQLAlchemy</span><span class="p">()</span>
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a><span class="k">def</span> <span class="nf">create_app</span><span class="p">(</span><span class="n">config_name</span><span class="p">):</span>
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>    <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>    <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_object</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="n">config_name</span><span class="p">])</span>
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>    <span class="n">config</span><span class="p">[</span><span class="n">config_name</span><span class="p">]</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>    <span class="n">bootstrap</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>    <span class="n">db</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>
<a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>    <span class="c1"># Routes or blueprints</span>
<a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>    <span class="kn">from</span> <span class="nn">.main</span> <span class="kn">import</span> <span class="n">main</span> <span class="k">as</span> <span class="n">main_blueprint</span>
<a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a>    <span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">main_blueprint</span><span class="p">)</span>
<a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a>
<a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a>    <span class="k">return</span> <span class="n">app</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p>5 Blueprint - sub pkg</p>
<ul>
<li>Blueprint is like app having routes but in dormant state until registered with an application which gives it a context.</li>
<li>Blueprint can be a single file, or structured as a sub-package having multiple modules and the package constructor creates blueprint.</li>
<li>5.1 <code>app/main/__init__.py</code> main bp creation<ul>
<li>Blueprint is native flask module</li>
<li>create object of <code>Blueprint()</code> class and pass it a name and location.</li>
<li>
<p>import associated modules</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Blueprint</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="n">main</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">views</span><span class="p">,</span> <span class="n">errors</span> 
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="c1"># last line to avoid circular dependency</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>5.4 <code>app/main/views.py</code> view routes<ul>
<li>route function name now has namespace with BP name as prefix, so <code>url_for('main.index')</code> should be used so that 'index' of any other BP is not picked.</li>
</ul>
</li>
<li>5.2 <code>app/main/errors.py</code> error handlers  <ul>
<li>they respond to only BP route error, for app wide use <code>app_errorhandler</code> decorator instead of <code>errorhandler</code>.</li>
</ul>
</li>
<li>5.3 <code>app/main/forms.py</code> has form objects.</li>
</ul>
</li>
</ul>
<ul>
<li>4 <code>flasky.py</code> module where app instance is denied<ul>
<li><code>create_app()</code> function is called.</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Link</strong> - <a href="http://exploreflask.com/en/latest/blueprints.html">http://exploreflask.com/en/latest/blueprints.html</a></li>
</ul>
<h2 id="testing-in-flask">Testing in Flask</h2>
<ul>
<li><strong>Why</strong><ul>
<li>function code only runs when it is called.</li>
<li>if else code is only called when condition is met.</li>
<li>ensure code for all branch and function is run by changing scenarios.</li>
<li>100% coverage is when you run all functions and code in all if else try catch is tested.</li>
<li>do test as you develop.</li>
<li><code>pytest</code> to test</li>
<li><code>coverage</code> to measure</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>PyTest</strong></p>
<ul>
<li>modules and functions both start with <code>test_</code></li>
<li>Fixtures are setup functions, that setup how app should behave<ul>
<li>You can build different fixtures to have different app instances or to test different interactions like client requests or CLI commands.</li>
<li>fixtures call app-factory with test configs to make app separate from dev config.</li>
<li><code>conftest.py</code> - sample below.<ul>
<li>here fixure creates app, which is then passed to other fixture for specific testing.</li>
<li><code>app.test_client()</code> lets make request to app without server. Available in <code>client</code> fixture.</li>
<li><code>app.test_cli_runner()</code> lets test CLI commands registered with app. Available in <code>runner</code> fixture.</li>
<li>these fixture names (client or runner) are passed in test_functions to use them.</li>
</ul>
</li>
<li>
<p>You can keep building fixture on top of other fixture to add predefined functionalities. Eg, on top of client add another class that can help login and logout.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">def</span> <span class="nf">app</span><span class="p">():</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>    <span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>    <span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>        <span class="n">init_db</span><span class="p">()</span>
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>    <span class="k">yield</span> <span class="n">app</span>
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a><span class="k">def</span> <span class="nf">client</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>    <span class="k">return</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span>
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>
<a id="__codelineno-27-12" name="__codelineno-27-12" href="#__codelineno-27-12"></a><span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<a id="__codelineno-27-13" name="__codelineno-27-13" href="#__codelineno-27-13"></a><span class="k">def</span> <span class="nf">runner</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
<a id="__codelineno-27-14" name="__codelineno-27-14" href="#__codelineno-27-14"></a>    <span class="k">return</span> <span class="n">app</span><span class="o">.</span><span class="n">test_cli_runner</span><span class="p">()</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>Test Cases<ul>
<li>start with <code>test_</code> in both module and function name.</li>
<li>
<p>use <code>assert</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">create_app</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="k">def</span> <span class="nf">test_hello</span><span class="p">(</span><span class="n">client</span><span class="p">):</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/hello&#39;</span><span class="p">)</span>   <span class="c1"># sends this URL request</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>    <span class="k">assert</span> <span class="n">response</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;Hello, World!&#39;</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li><code>pytest.mark.parametrize</code> lets run the test with different params</li>
<li>to test context variables like <code>session</code> or <code>g</code> use <code>with client:</code> Otherwise it raises an error.</li>
<li><code>setup.cfg</code> can have extra configs (not mandatory).</li>
</ul>
<ul>
<li><strong>Run - Pytest</strong><ul>
<li><code>pytest</code> runs test</li>
<li><code>pytest -v</code> runs and shows all files</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Report - Coverage</strong></p>
<ul>
<li><code>coverage run -m pytest</code> runs tests and measures coverage</li>
<li><code>coverage run -m unittest</code> runs tests using unittest and measures coverage</li>
<li><code>coverage report</code> shows coverage report on CLI</li>
<li><code>coverage html</code> builds dir for detailed report<ul>
<li><code>htmlcov/index.html</code> has detailed report.</li>
<li>shows code covered and not covered.</li>
</ul>
</li>
<li>To exempt a code block from coverage, add <code># pragma: no cover</code> after code block. Make this a tough decision to skip code from testing.</li>
</ul>
<ul>
<li>more <a href="https://flask.palletsprojects.com/en/2.2.x/tutorial/tests/">here</a></li>
</ul>
</li>
</ul>
<ul>
<li><strong>Manual Testing</strong><ul>
<li>Basic testing can be done using flask shell and executing functions <code>flask --app flasky.py shell</code></li>
<li>do things similar to as you do in wrinting code, like import module, create objects, call functions etc.</li>
<li>use <code>current_app</code> to use <code>app_context</code>, or</li>
<li><code>with app.app_context():</code> when using factory</li>
<li>What you test in shell should be automated by making test cases.</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>UnitTest</strong> - test small units</p>
<ul>
<li>use py native <code>import unittest</code></li>
<li>in <code>tests/test_basics.py</code><ul>
<li>import modules you need for test, <code>create_app</code>, <code>db</code></li>
<li>import modules you want to test, <code>User</code>, <code>current_app</code></li>
<li>define class <code>class BasicsTestCase(unittest.TestCase):</code><ul>
<li>build functions<ul>
<li><code>setUp()</code> runs before each test, builds env for testing</li>
<li><code>tearDown()</code> runs after each test, removes things from env</li>
<li><code>test_somecase()</code> these functions run as test.<ul>
<li><code>assertTrue</code> Ok if True</li>
<li><code>assertFalse</code> Ok if False</li>
<li><code>with self.assertRaises(AttributeError):</code> statement that raise error.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>tests can be written in separate py files (modules) and the folder <code>tests</code> can have <code>__init__.py</code> as blank to make it a pkg</li>
<li>in <code>flasky.py</code> you can add code to run tests automatically by adding a cli command.</li>
<li>do <code>flask --app flasky.py test</code> to run all test cases<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nd">@app</span><span class="o">.</span><span class="n">cli</span><span class="o">.</span><span class="n">command</span><span class="p">()</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">  </span><span class="sd">&quot;&quot;&quot;Run the unit tests.&quot;&quot;&quot;</span> <span class="c1"># help msg on cli</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a>  <span class="kn">import</span> <span class="nn">unittest</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a>  <span class="n">tests</span> <span class="o">=</span> <span class="n">unittest</span><span class="o">.</span><span class="n">TestLoader</span><span class="p">()</span><span class="o">.</span><span class="n">discover</span><span class="p">(</span><span class="s1">&#39;tests&#39;</span><span class="p">)</span>
<a id="__codelineno-29-6" name="__codelineno-29-6" href="#__codelineno-29-6"></a>  <span class="n">unittest</span><span class="o">.</span><span class="n">TextTestRunner</span><span class="p">(</span><span class="n">verbosity</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tests</span><span class="p">)</span>
</code></pre></div>
</li>
</ul>
<ul>
<li><code>python -m unittest</code> discovers and runs all tests.</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Unittest vs PyTest</strong><ul>
<li>Unittest is universally accepted and is built in Python standard library</li>
<li>PyTest has lot of features and we need to write less</li>
<li>Unitest needs classes &amp; methods. Pytest only needs methods.</li>
<li>Pytest runner has <strong>full support</strong> for test cases written in UnitTest clasees.</li>
<li><strong>Use both</strong>, OOPs of Unittest and better assert of Pytest with and its better error reporting.</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Unittest and PyTest</strong></p>
<ul>
<li>You can use Unittest and Pytest togehter to make use of best of both.</li>
</ul>
<ul>
<li><strong>Test Parametrization</strong><ul>
<li>when you have same test-code but have to run with different input parameters.</li>
<li>Pytest uses non OOPs params, to make Unittest OOPs model work with PyTest add <code>pip install parameterized</code>.</li>
<li>then use its decorator and pass params as list of tuples to argument.</li>
<li>list is input scenarios</li>
<li>tuple is variables in each scenario. One value tuple is <code>('name1',)</code></li>
<li>
<p>Eg, <code>[('name1',32), ('name2',24)]</code>, <code>@parameterized.expand([(n,) for n in range(9)])</code>, <code>@parameterized.expand(itertools.product([True, False], range(9)))</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="k">class</span> <span class="nc">TestLife</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>    <span class="c1"># ...</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>    <span class="nd">@parameterized</span><span class="o">.</span><span class="n">expand</span><span class="p">([(</span><span class="s1">&#39;name1&#39;</span><span class="p">,</span><span class="mi">32</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;name2&#39;</span><span class="p">,</span><span class="mi">24</span><span class="p">)])</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>    <span class="k">def</span> <span class="nf">test_load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span> <span class="c1"># this method runs the number of items in list.</span>
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>        <span class="n">u</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">)</span>
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>        <span class="k">assert</span> <span class="n">u</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Test Exceptions</strong><ul>
<li>
<p><code>pytest.raises()</code> can be used to test if a certain error is raised on run time.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="k">with</span> <span class="n">pytest</span><span class="o">.</span><span class="n">raises</span><span class="p">(</span><span class="ne">RuntimeError</span><span class="p">):</span>
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>    <span class="n">data</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;corrupt_data.txt&#39;</span><span class="p">)</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Mocking</strong><ul>
<li>When you have to change return value of a pre defined function. You can mock a function to return a specific value irrespective of what is passed to it without modifying its code.</li>
<li>More here on <a href="https://blog.miguelgrinberg.com/post/how-to-write-unit-tests-in-python-part-2-game-of-life#:~:text=72%20different%20tests!-,Mocking,-We%20are%20now">MG's Unit Testing - Mocking</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Test Code Structure</strong></p>
<ul>
<li>create a test module (file) of same name as test subject with test_ prefixed. Eg, <code>test_foo.py</code></li>
<li>import <code>unittest</code> and other required packages</li>
<li>create classes and methods for testing.</li>
<li>
<p>in test_method</p>
<ul>
<li>call code from your app, set varibles or directly put code in assert</li>
<li><code>assert some-code</code> some-code can be anything that evaluates to True.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="kn">import</span> <span class="nn">unittest</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="kn">from</span> <span class="nn">app</span> <span class="kn">import</span> <span class="n">User</span><span class="p">,</span> <span class="n">Engine</span>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="k">class</span> <span class="nc">TestUserAdd</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>    <span class="k">def</span> <span class="nf">test_works</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>        <span class="n">u</span> <span class="o">=</span> <span class="n">User</span><span class="p">()</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>        <span class="k">assert</span> <span class="n">u</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="c1"># anything that evalueates to True</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a><span class="k">class</span> <span class="nc">TestEngineWork</span><span class="p">(</span><span class="n">unittest</span><span class="o">.</span><span class="n">TestCase</span><span class="p">):</span>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>    <span class="k">pass</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>For a <strong>Flask App</strong></p>
<ul>
<li><code>setUp</code> and <code>tearDown</code> methods are special that automatically invoked before and after each test case. This makes every test case run on clean slate. You can have different one in each class, or make a base class and import it in other classes.</li>
<li>request functions<ul>
<li><code>response = app.client.get('/', follow_redirects=True)</code> - use response same as you do in flask app</li>
<li><code>response = self.client.post('/auth/register', data={some_json}, follow_redirects=True)</code> - submit a form this way</li>
</ul>
</li>
</ul>
<ul>
<li>response methods<ul>
<li><code>html = response.get_data(as_text=True)</code></li>
<li><code>assert response.status_code == 200</code></li>
<li><code>assert response.request.path == '/auth/login' # redirected to login</code></li>
<li><code>response.json['token']</code></li>
</ul>
</li>
</ul>
<p>```python</p>
<h1 id="teststest_basepy">tests/test_base.py</h1>
<p>import unittest
from flask import current_app
from app import create_app, db</p>
<p>class TestWebApp(unittest.TestCase):
    def setUp(self):
        self.app = create_app()
        self.appctx = self.app.app_context()
        self.appctx.push()
        db.do_something() # you can call any method as well here
        self.do_something() # method in this class that has code to be executed before each test, like register
        self.client = self.app.test_client()</p>
<div class="highlight"><pre><span></span><code>def tearDown(self):
    db.drop_something() # again execute anything at end of test case
    self.appctx.pop()
    self.app = None
    self.appctx = None
    self.client = None

def test_app(self):
    assert self.app is not None
    assert current_app == self.app

def test_home_page_redirect(self):
    response = self.client.get(&#39;/&#39;, follow_redirects=True)
    slef.do_login() # funciton in this class that logs in to the app can be reused
    assert response.status_code == 200
    assert response.request.path == &#39;/auth/login&#39;
```
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Do s</strong><ul>
<li>
<p>If a piece of code is difficult to test with test case, consider refactoring it. Eg, some code that is not in funciton and just prints as part of execution can't be called from test case, so make a function for it. Alos, you can wrap any global code in a function and call it. This also makes code <strong>only direct</strong> executable when file is ran, <strong>import doesn't</strong> execute it.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>    <span class="n">all_your_global_code</span><span class="p">()</span>
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>Links<ul>
<li><a href="https://blog.miguelgrinberg.com/post/how-to-write-unit-tests-in-python-part-3-web-applications">MG' Flask Web App Testing</a></li>
<li><a href="https://github.com/miguelgrinberg/python-testing/blob/main/life/test_life.py">MS's Testing code for Life Game</a></li>
<li><a href="https://stackoverflow.com/questions/27954702/unittest-vs-pytest">Stackoverflow why to use PyTest</a></li>
<li><a href="https://flask.palletsprojects.com/en/2.2.x/tutorial/tests/">Flask Docs - Pure Pytest</a></li>
<li><a href="https://realpython.com/python-web-applications-with-flask-part-iii/">RealPython - Flask testing</a> has a different package, so differs</li>
</ul>
</li>
</ul>
<h2 id="error-handling">Error Handling</h2>
<ul>
<li>We can have templates for exceptions and errors so they don't go out to end users.</li>
<li>Link <a href="https://realpython.com/python-web-applications-with-flask-part-iii/#error-handling">RealPython Flask App Part III</a></li>
</ul>
<h2 id="log-in-flask">Log in Flask</h2>
<ul>
<li>A standard Python logging component <code>logger</code> is available on the Flask object at <code>app.logger</code>.</li>
<li>404 is autologged by server, so skip.</li>
<li>request logs are autologged by proxy server, so skip.</li>
<li>Exceptions, 400 and 500 can be logged to look back in time.</li>
</ul>
<ul>
<li>Setup<ul>
<li>configure logger as early as possible</li>
<li>add path and log configs in <code>config.py</code> even before app is created. You can add logging config to any env config class. They are all called before app is created.</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kn">import</span> <span class="nn">logging</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="n">app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;some log&#39;</span><span class="p">)</span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="c1"># prj/config.py</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="kn">import</span> <span class="nn">logging</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">%(asctime)s</span><span class="s1">] - </span><span class="si">%(name)s</span><span class="s1"> - </span><span class="si">%(levelname)s</span><span class="s1"> - </span><span class="si">%(module)s</span><span class="s1"> -: </span><span class="si">%(message)s</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="c1"># prj/app/models.py</span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">current_app</span>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a><span class="n">current_app</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Some message&#39;</span><span class="p">)</span>
</code></pre></div>
<ul>
<li>
<p>Explore <a href="https://memgraph.com/blog/graph-web-application#:~:text=Docker%20fanboy%20alert-,1.%20Create%20a%20Flask%20server,-I%20included%20comments">here</a></p>
<p>```py
log = logging.getLogger(<strong>name</strong>)</p>
<p>def init_log():
    logging.basicConfig(level=logging.DEBUG)
    log.info("Logging enabled")
    # Set the log level for werkzeug to WARNING because it will print out too much info otherwise
    logging.getLogger("werkzeug").setLevel(logging.WARNING)
  ```</p>
</li>
</ul>
<ul>
<li>Links<ul>
<li><a href="https://flask.palletsprojects.com/en/2.2.x/logging/#basic-configuration">FlaskDocs - Config Logger</a></li>
<li><a href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-vii-unit-testing-legacy#:~:text=the%20console%20window.-,Logging%20to%20a%20file,-Receiving%20errors%20via">MG - Logging to a File Legacy</a></li>
<li><a href="https://realpython.com/python-web-applications-with-flask-part-iii/#logging">RealPython - Flask Part III - Logging</a>. Eg, shows to Log Errors, keep 7 days history.</li>
</ul>
</li>
</ul>
<h2 id="make-the-project-installable">Make the Project Installable</h2>
<ul>
<li>Makes the project distributable like a library, so people can do <code>pip install</code> and use it.</li>
<li>Deploying is same as installing any other library. like you deploy <code>mkdocs</code> by installing it.</li>
<li>
<p><code>setup.py</code> outside <code>app</code> is where we can define this.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">find_packages</span><span class="p">,</span> <span class="n">setup</span>
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="n">setup</span><span class="p">(</span>
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;your-project-name&#39;</span><span class="p">,</span>
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.0.0&#39;</span><span class="p">,</span>
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>    <span class="n">packages</span><span class="o">=</span><span class="n">find_packages</span><span class="p">(),</span>
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>    <span class="n">include_package_data</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>    <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span>
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>        <span class="s1">&#39;flask&#39;</span><span class="p">,</span>
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>    <span class="p">],</span>
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a><span class="p">)</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>also add <code>MAINFEST.in</code> to tell what other files to include in package. Eg, <code>some.sql</code> <code>static</code> or any other.</li>
<li>more <a href="https://flask.palletsprojects.com/en/2.2.x/tutorial/install/#describe-the-project">here</a></li>
<li><a href="https://realpython.com/python-web-applications-with-flask-part-iii/#logging">RealPython Flask App part III</a></li>
</ul>
<h2 id="deployment-fundamentals">Deployment Fundamentals</h2>
<ul>
<li>WSGI or "Web Server Gateway Interface"<ul>
<li>is a protocol (calling convention) to forward requests from a web server (Apache or NGINX) to a backend Python web application or framework. Python then builds response which is passed back to the webserver which shares it to the requestor.</li>
<li>it sits between Web Server and Python App. <code>Client -&gt; Webserver -&gt; WSGI -&gt; Python</code></li>
<li>WSGI containers are Gunicorn, uWSGI. They invoke python callable object, such as a route in flask.</li>
<li>WSGI container is <strong>required</strong> to be <strong>installed</strong> in the <strong>project</strong> so that a web server can communicate to a WSGI container which further <strong>communicates</strong> to the <strong>Python</strong> application and provides the response back accordingly.</li>
</ul>
</li>
</ul>
<ul>
<li>Development Web Server<ul>
<li>most frameworks come with development web server which serves requests. but this needs to be replaced on PROD.</li>
</ul>
</li>
</ul>
<ul>
<li>Links<ul>
<li><a href="https://www.liquidweb.com/kb/what-is-wsgi/">What is WSGI</a></li>
</ul>
</li>
</ul>
<h2 id="deployment-windows-iis-server">Deployment - Windows IIS Server</h2>
<ul>
<li><code>HTTP -&gt; IIS -&gt; ISAPI -&gt; FastCGI -&gt; WSGI -&gt; (Python Flask Application)</code></li>
</ul>
<ul>
<li>IIS site will trigger a <code>wfastcgi.py</code> script and will use <code>web.config</code> file which calls module that has flask app (or creates using app factory).</li>
<li>WFastCGI is a Py package, and <code>wfastcgi.py</code> provides a bridge between IIS and Python using WSGI and FastCGI. It is same as mod_python is for Apache.</li>
<li>you can impersonate as a user in appPoolIdentity</li>
<li>you can disable anonymous auth and can keep only windows authenticated access to get remote user in request.</li>
</ul>
<ul>
<li>Links<ul>
<li><a href="https://medium.com/@dpralay07/deploy-a-python-flask-application-in-iis-server-and-run-on-machine-ip-address-ddb81df8edf3">Detailed deployment process on Medium</a></li>
</ul>
</li>
</ul>
<h2 id="deployment-pythonanywhere-flask">Deployment - PythonAnywhere Flask</h2>
<ul>
<li>
<p>WSGI configuration</p>
<ul>
<li>On your Web App Configuration page, open "WSGI configuration file", and ensure you add your project folder to code below.</li>
</ul>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="kn">import</span> <span class="nn">sys</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="c1"># add your project directory to the sys.path</span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="n">project_home</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;/home/username/mysite&#39;</span>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="k">if</span> <span class="n">project_home</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>    <span class="n">sys</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">project_home</span><span class="p">]</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="c1"># import flask app but need to call it &quot;application&quot; for WSGI to work</span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="kn">from</span> <span class="nn">flask_app</span> <span class="kn">import</span> <span class="n">app</span> <span class="k">as</span> <span class="n">application</span>  <span class="c1"># noqa</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>more <a href="https://flask.palletsprojects.com/en/2.2.x/tutorial/deploy/">here</a></li>
</ul>
<h2 id="static-site-with-flask-frozen">Static Site with Flask-Frozen</h2>
<ul>
<li>Static site can be generated and hosted on Netlify or GitHub pages.</li>
</ul>
<ul>
<li>link<ul>
<li><a href="https://testdriven.io/blog/static-site-flask-and-netlify/">td.io - Frozen</a></li>
</ul>
</li>
</ul>
<h2 id="access-localhost-flask-app-on-network">Access localhost flask app on Network</h2>
<ul>
<li>Suppose on an Ubuntu VM a flask app is running on localhost and you want to access it from you host machine that is Mac.</li>
</ul>
<ul>
<li>Run flask app with <code>app.run(host='0.0.0.0', debug=True)</code></li>
<li>This tells your operating system to listen on all public IPs.</li>
<li>then access <code>192.168.10.33:5000</code> from host machine.</li>
</ul>
<p>Now that our app is running we can add a database to this app. We will use FlaskSQLAlchemy package for this. Or Pandas.</p>
<h2 id="machine-learning-pandas-app-in-flask">Machine Learning Pandas App in Flask</h2>
<p>You can use Flask it with Pandas, Matplot and other ML libraries to make it easily usable for end users.</p>
<ul>
<li>Import all your libs in flask app that you have used in Jupyter NB.</li>
<li>Add code and functions to read data and perform tasks.</li>
<li>Flask routes are executed for each request, so keep data reads outside to read them once.</li>
<li><code>return render_template( 'search.html', data=df_result.to_html(classes='table table-striped table-hover')</code> - to_html makes html table that can be passed to html page.</li>
<li><code>{{ data|safe }}</code> - safe makes it as markup and browser renders it.</li>
</ul>
<p>Reference:</p>
<ul>
<li><a href="https://sarahleejane.github.io/learning/python/2015/08/09/simple-tables-in-webapps-using-flask-and-pandas-with-python.html">https://sarahleejane.github.io/learning/python/2015/08/09/simple-tables-in-webapps-using-flask-and-pandas-with-python.html</a></li>
</ul>
<h2 id="charts-graphs-visualization-in-flask">Charts Graphs Visualization in Flask</h2>
<ul>
<li>Requirements<ul>
<li>HTML5 instead of PNG</li>
<li>dynamic, shows info on hover</li>
<li>interactive, filters modify charts</li>
<li>dashboard, filters update multiple charts</li>
<li>streaming dataset</li>
<li>animation</li>
</ul>
</li>
</ul>
<ul>
<li>Plotly<ul>
<li>dynamic &amp; interactive charts</li>
<li>handle data and build-chart in view function, then send JSON to template, use JSON in JS.</li>
</ul>
</li>
</ul>
<ul>
<li>Plotly Express<ul>
<li><code>import plotly.express as px</code></li>
<li><code>fig = px.bar()</code> lets build bar</li>
<li><code>fig.show()</code> makes PNG</li>
</ul>
</li>
</ul>
<ul>
<li>Plotly Graph Objects<ul>
<li><code>import plotly.graph_objects as go</code> builds figure objects.</li>
<li>has class for object like <code>go.Bar()</code></li>
<li>objects need to be added to figure <code>fig = px.Figure()</code></li>
</ul>
</li>
</ul>
<ul>
<li>Bokeh<ul>
<li>beautiful charts, simple plot to complex dashboard with streaming dataset!</li>
<li>dynamic &amp; interactive</li>
<li><code>bokeh.plotting</code> has plotting functions</li>
<li><code>bokeh.models</code> has data handling functions</li>
<li><code>bokeh.embed</code> has component that return HTML with JS ready to embedd, when python <code>fig</code> is passed.</li>
</ul>
</li>
</ul>
<ul>
<li>Dash<ul>
<li>React front-end - yes</li>
<li>dashboard - yes</li>
<li>HTML in Python - NOooo</li>
<li><code>from dash import Dash, html, dcc</code><ul>
<li>Dash is app</li>
<li>html lets build html components <code>Div()</code> H1</li>
<li>dcc is Dash Core Components - lets build <code>Graph() Dropdown()</code>, graph has figues, from px.</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Flask, Plotly &amp; AJAX<ul>
<li>Flask app and html template</li>
<li>use <code>json.dumps()</code> to get fig JSON and send to template</li>
<li>use list of <code>chartJSON[]</code> for sending multiple charts</li>
<li>template can use plotly js to plot chart with the json.</li>
<li>js <code>Plotly.plot('chart',graphs,{});</code> where <code>chart</code> is <code>id</code> of <code>div</code></li>
<li>to extend, send graphJSON, header, description</li>
<li>AJAX<ul>
<li><code>onchange=cb(this.value)</code> to invoke callback function, that passes value to python and python returns updated chartJSON</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Data Handling<ul>
<li>mostly libraries use list, which has series from DataFrame</li>
<li>px takes in dataframe as <code>data</code></li>
</ul>
</li>
</ul>
<ul>
<li>Altair<ul>
<li>py library</li>
</ul>
</li>
</ul>
<ul>
<li>Chart.js<ul>
<li>No Python wrapper</li>
<li>is dynamic</li>
</ul>
</li>
</ul>
<ul>
<li>Highchart, google charts, d3.js ?</li>
</ul>
<ul>
<li>anychart<ul>
<li>can be drawn from JSON, JSON needs to build without python wrapper</li>
</ul>
</li>
</ul>
<ul>
<li>Matplot, ggplot<ul>
<li>static chart, save fig as png, return file from view_function</li>
</ul>
</li>
</ul>
<ul>
<li>Links<ul>
<li><a href="https://towardsdatascience.com/web-visualization-with-plotly-and-flask-3660abf9c946">TDS - Web Visualization with Plotly and Flask</a></li>
<li><a href="https://towardsdatascience.com/an-interactive-web-dashboard-with-plotly-and-flask-c365cdec5e3f">TSD - Flask plotly AJAX</a></li>
<li><a href="https://dash.plotly.com/layout">Dash offical</a></li>
</ul>
</li>
</ul>
<h2 id="restapi-in-flask">RestAPI in Flask</h2>
<p>What is REST?</p>
<ul>
<li>Client and Server are separate</li>
<li><strong>Stateless:</strong> No information from a request is stored on client to be used in other requests, eg, no session can be started, if authentication is required, username and password need to be sent with every request.</li>
</ul>
<p>What is RESTful API:</p>
<ul>
<li>There is a resource, eg, tasks</li>
<li>It has endpoints for CRUD operations</li>
<li>HTTP methods, GET PUT POST DELETE, are used for these operations.</li>
<li>Data is provided with these requests in no particular format but usually as:<ul>
<li>JSON blob in request body, or</li>
<li>Query String arguments as portion of URL.</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>HTTP Method</th>
<th>URI</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td><a href="http://[hostname]/todo/api/v1.0/tasks">http://[hostname]/todo/api/v1.0/tasks</a></td>
<td>Retrieve list of tasks</td>
</tr>
<tr>
<td>GET</td>
<td><a href="http://[hostname]/todo/api/v1.0/tasks/[task_id]">http://[hostname]/todo/api/v1.0/tasks/[task_id]</a></td>
<td>Retrieve a task</td>
</tr>
<tr>
<td>POST</td>
<td><a href="http://[hostname]/todo/api/v1.0/tasks">http://[hostname]/todo/api/v1.0/tasks</a></td>
<td>Create a new task</td>
</tr>
<tr>
<td>PUT</td>
<td><a href="http://[hostname]/todo/api/v1.0/tasks/[task_id]">http://[hostname]/todo/api/v1.0/tasks/[task_id]</a></td>
<td>Update an existing task</td>
</tr>
<tr>
<td>DELETE</td>
<td><a href="http://[hostname]/todo/api/v1.0/tasks/[task_id]">http://[hostname]/todo/api/v1.0/tasks/[task_id]</a></td>
<td>Delete a task</td>
</tr>
</tbody>
</table>
<p>Data of a task can be, JSON blob, as:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="p">{</span>
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>  <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a>  <span class="s1">&#39;title&#39;</span><span class="p">:</span> <span class="s1">&#39;Title of a to do task&#39;</span><span class="p">,</span>
<a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a>  <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Description of to do task&#39;</span><span class="p">,</span> 
<a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a>  <span class="s1">&#39;done&#39;</span><span class="p">:</span> <span class="kc">False</span>
<a id="__codelineno-37-6" name="__codelineno-37-6" href="#__codelineno-37-6"></a><span class="p">}</span>
</code></pre></div>
<ul>
<li>This API can be consumed by client side app which can be single page HTML.</li>
<li>Note, JSON object is defined in python as dict, <code>jonify</code> converts and send as JSON Object.</li>
</ul>
<h2 id="jwt-authentication-in-flask">JWT Authentication in Flask</h2>
<ul>
<li>JWT Authentication<ul class="task-list">
<li><code>jwt</code> python library is used to make a <code>token</code> that can be send in every request instead of sending username and password.</li>
<li>Token is encoded string which has a valid time and it expires after that time.</li>
<li><code>ExpiredSignatureError</code> is raised if you <code>decode</code> and expired token string.</li>
<li class="task-list-item"><input type="checkbox"/> how to add remember me.</li>
</ul>
</li>
</ul>
<ul>
<li>how to register?<ul>
<li>comment <code>token_authentication</code> for <code>create_user</code></li>
<li><code>curl -i -X POST -H "Content-Type: application/json" -d '{"username":"admin","password":"admin"}' http://127.0.0.1:5000/admin</code></li>
</ul>
</li>
</ul>
<ul>
<li>CURL Requests<ul class="task-list">
<li>Send Username and password to get token<ul>
<li><code>curl -u username:password -i -X GET http://127.0.0.1:5000/login</code> returns token and duration</li>
</ul>
</li>
<li>Send token in header to access protected resources<ul>
<li><code>curl -H "x-access-token: token" -i -X GET http://127.0.0.1:5000/users</code></li>
<li><code>curl -H "x-access-token: token" -i -X GET http://127.0.0.1:5000/users/9d8c738b-3a39-482d-8a17-0c1b755f9a23</code></li>
<li><code>curl -H "x-access-token: token" -i -X GET http://127.0.0.1:5000/api/v1.0/tasks</code></li>
<li><code>curl -H "x-access-token: token" -i -X GET http://127.0.0.1:5000/api/v1.0/tasks/19</code></li>
</ul>
</li>
<li class="task-list-item"><input type="checkbox"/> will this be more secure and beneficial?<ul>
<li><code>curl -u username_or_token:password_or_unused -i -X GET http://127.0.0.1:5000/users</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="app-restful-api-in-flask">App - RESTful API in Flask</h2>
<p>to be added</p>
<h2 id="serving-over-https">Serving over HTTPS</h2>
<ul>
<li>generate certificate key using <code>openssl req -x509 -newkey rsa:4096 -nodes -out cert.pem -keyout key.pem -days 365</code></li>
<li>allow insecure connection to localhost in chrome, paste <code>chrome://flags/#allow-insecure-localhost</code></li>
<li><a href="https://blog.miguelgrinberg.com/post/running-your-flask-application-over-https">https://blog.miguelgrinberg.com/post/running-your-flask-application-over-https</a></li>
</ul>
<h2 id="app-social-blogging-app-in-flask">App - Social Blogging App in Flask</h2>
<ul>
<li>
<p><strong>User Authentication</strong></p>
<ul>
<li><strong>Password hashing</strong><ul>
<li>extensions - <code>from werkzeug.security import generate_password_hash, check_password_hash</code> this is tried and tested lib that is safe to use.</li>
<li>model - implement <code>password</code> as write-only property of <code>User</code> class to set <code>password_hash</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>Blueprint</strong> - structure it as a sub-module <code>auth</code> Blueprint. It has view having login-route</li>
</ul>
<ul>
<li>
<p><strong>Normal auth</strong></p>
<ul>
<li>Login - <code>session['user_id'] = user['id']</code> once credentials are verified, save <code>user_id</code> in <code>session</code> dictionary, it makes it available across requests for the session.<ul>
<li>
<p><code>g.User</code> can hold user object. Using Blueprints decorator <code>@bp.before_app_request</code> register a function that sets <code>g.user</code>. If there is no <code>user_id</code> in session, <code>g.User</code> will be <code>None</code></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="nd">@bp</span><span class="o">.</span><span class="n">before_app_request</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="k">def</span> <span class="nf">load_logged_in_user</span><span class="p">():</span>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>    <span class="n">user_id</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;user_id&#39;</span><span class="p">)</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>    <span class="k">if</span> <span class="n">user_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>        <span class="n">g</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>        <span class="n">g</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">get_db</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span>
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>        <span class="s1">&#39;SELECT * FROM user WHERE id = ?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">user_id</span><span class="p">,)</span>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>        <span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>Logout - <code>session.clear()</code></li>
</ul>
<ul>
<li>
<p>Login Required Decorator - lets you use <code>@login_required</code> on view function so the following code is run before view-route code.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="k">def</span> <span class="nf">login_required</span><span class="p">(</span><span class="n">view</span><span class="p">):</span>
<a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
<a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a>    <span class="k">def</span> <span class="nf">wrapped_view</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a>        <span class="k">if</span> <span class="n">g</span><span class="o">.</span><span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a>            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;auth.login&#39;</span><span class="p">))</span>
<a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a>
<a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a>        <span class="k">return</span> <span class="n">view</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a>
<a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a>    <span class="k">return</span> <span class="n">wrapped_view</span>
</code></pre></div>
</li>
</ul>
</li>
</ul>
<ul>
<li>
<p><strong>Flask-login</strong> is ext having functions and decorators that make authentication easy.</p>
<ul>
<li>model - few required class members can either be declared in <code>User</code> class or can be importe from <code>UserMixin</code> class of Flask-login.</li>
<li>
<p>initialize and instantiate extension with required conf</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="kn">from</span> <span class="nn">flask_login</span> <span class="kn">import</span> <span class="n">LoginManager</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="n">login_manager</span> <span class="o">=</span> <span class="n">LoginManager</span><span class="p">()</span>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="n">login_manager</span><span class="o">.</span><span class="n">login_view</span> <span class="o">=</span> <span class="s1">&#39;auth.login&#39;</span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="k">def</span> <span class="nf">create_app</span><span class="p">(</span><span class="n">config_name</span><span class="p">):</span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>  <span class="c1"># ...</span>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>  <span class="n">login_manager</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a>  <span class="c1"># ...</span>
</code></pre></div>
</li>
</ul>
<ul>
<li>
<p>model implement user_loader in <code>User</code> class</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">login_manager</span>
<a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>
<a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="nd">@login_manager</span><span class="o">.</span><span class="n">user_loader</span>
<a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="k">def</span> <span class="nf">load_user</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
<a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>  <span class="k">return</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">user_id</span><span class="p">))</span>
</code></pre></div>
</li>
</ul>
<ul>
<li><code>login_required</code> decorator lets protect route.</li>
<li>Flask-Logins <code>login_user()</code> logs user in once verified. It setts user session.</li>
<li><code>logout_user()</code> logs user out.</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Register User</strong><ul>
<li>build a form class in new <code>auth/forms.py</code>, add unique email and username validator using <code>validate_</code> function</li>
<li>build a template that uses form <code>templates/auth/register.html</code></li>
<li>build a register route in <code>auth/views.py</code><ul>
<li>get - render form</li>
<li>post - validate and add user to db</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>account confirmations</strong><ul>
<li>use expiry token to validate email url.</li>
<li>model - add token generation and validation function.</li>
<li>view - send email on registration</li>
<li>view - <code>@auth.route('/confirm/&lt;token&gt;')</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>Links</strong><ul>
<li><a href="https://realpython.com/using-flask-login-for-user-management-with-flask/">RealPython Flask-Login</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li><strong>Roles and Permissions</strong><ul>
<li>database implementation<ul>
<li>add <code>role</code> table</li>
<li>add <code>permission</code> column to role table as integer<ul>
<li>multiple permission can be binary numbers, 1,2,4,8,16</li>
<li>add them and subtract them to get unique number as total permission of user. 2+4=6</li>
<li>do bit wise and operation to match permission. 6&amp;2=2, 6&amp;4=4</li>
</ul>
</li>
</ul>
</li>
<li>add decorator function to make it easy to protect route to access only if permission is checked.</li>
</ul>
</li>
</ul>
<ul>
<li><strong>User Profiles</strong></li>
</ul>
<h2 id="app-mega-tutorial-by-mg">App - Mega Tutorial by MG</h2>
<p><em>This is understanding of a tutorial by Miguel Grinberg, we are learning to create a micro-blogging site using flask and other dependencies.</em></p>
<ul class="task-list">
<li class="task-list-item"><input type="checkbox"/> UserMixin?</li>
<li class="task-list-item"><input type="checkbox"/> Why we pass Classes as param to Class?</li>
</ul>
<h2 id="elastic-search-in-flask">Elastic Search in Flask</h2>
<ul>
<li>You can install elastic search by <code>brew install elasticsearch</code> on mac.</li>
<li>Access <code>http://localhost:9200</code> to view service JSON output.</li>
<li>Also, install in python <code>pip install elasticsearch</code></li>
<li>To have launched start elasticsearch now and restart at login: <code>brew services start elasticsearch</code></li>
<li>Or, if you don't want/need a background service you can just run: <code>elasticsearch</code></li>
</ul>
<h2 id="advanced-flask">Advanced Flask</h2>
<ul>
<li>
<p>Request Processing</p>
<ul>
<li>
<p>Following diagram show the cycle of request-response</p>
<pre class="mermaid"><code>graph LR
Request --&gt;|GET\n1| Web_Server
Web_Server --&gt; WSGI_Server
WSGI_Server --&gt;|Spawns\n2| Flask_App
Flask_App --&gt;|Pushes\n3| Application_Context
Flask_App --&gt;|Pushes| Request_Context
Application_Context --&gt;|current_app\n4| View_Function
Request_Context --&gt;|request| View_Function
subgraph Global
Application_Context
Request_Context
end
subgraph Worker
Flask_App --&gt; View_Function
end
View_Function --&gt;|5| Response</code></pre>
</li>
</ul>
<ul>
<li>Step 1 - Handle request<ul>
<li>Web_server - Apache &amp; NginX</li>
<li>WSGI_Server - Gunicorn, uWSGI, mod_wsgi</li>
</ul>
</li>
<li>Step 2 - Spawn a <strong>Worker</strong><ul>
<li>it can be a thread, process or coroutine.</li>
<li><strong>one worker</strong> handles <strong>one request</strong> at a time.</li>
<li>hence for multiple concurrent request multiple worker can be spawned.</li>
</ul>
</li>
<li>Step 3 - pushes context<ul>
<li>worker pushes context to global-stack as <code>context-local</code> which uses <code>thread-local</code> data, which means, a worker, which is one thread, has data specific to a thread and can be only accessed by worker that created it. So its global-memory but worker-unique data as <code>global LocalStack()</code>.</li>
</ul>
</li>
<li>Step 4 - local context, proxy<ul>
<li>this context data is basically an object, stored as stack data structure. To make it available in view-function it is not passed as a parameter, neither is imported as a global object, rather it is made available using proxy</li>
</ul>
</li>
<li>Step 5 - Clean Up<ul>
<li>req and app context are removed from stack</li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li>Threading</li>
</ul>
<ul>
<li>Link<ul>
<li><a href="https://testdriven.io/blog/flask-contexts-advanced/#:~:text=The%20Flask%20app%20generates%20a,server%2C%20and%20a%20web%20application.">td.io - Request processing</a></li>
</ul>
</li>
</ul>
<h2 id="links">Links</h2>
<ul>
<li><a href="https://flask.palletsprojects.com/en/latest/tutorial/">Official Flask Blogging Tutorial - Flaskr</a><ul>
<li>app factory, blueprint</li>
<li>Plane DB operations, no ORM SQLAlchemy</li>
</ul>
</li>
<li><a href="https://realpython.com/python-web-applications-with-flask-part-i/">RealPython Flask Tutorial - Part I</a></li>
<li><a href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world">Flask Mega Tutorial I - Miguel Grinberg</a></li>
<li><a href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world-legacy">Flask Mega Tutorial I Legacy - Miguel Grinberg</a><ul>
<li>no blueprint.</li>
</ul>
</li>
</ul>

  <!-- taken from 
https://github.com/squidfunk/mkdocs-material/blob/master/src/partials/source-file.html -->



<hr />
<div class="md-source-file">
    <small>

        
            <span class="md-icon" title="Last Updated">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
            </span> 
            <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2023-03-10T18:24:28+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-03-10</span>
        
        

        
            <span class="md-icon" title="Written On">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
            </span>
            <span> May 2019 </span>
        
        
    </small>
</div>







                

    
    

              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2016 - 2023 Vaibhav Yadav
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://in.linkedin.com/in/iyadavvaibhav" target="_blank" rel="noopener" title="in.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/iYadavVaibhav/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/iYadavVaibhav/" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.kaggle.com/iyadavvaibhav/kernels" target="_blank" rel="noopener" title="www.kaggle.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M304.2 501.5 158.4 320.3 298.2 185c2.6-2.7 1.7-10.5-5.3-10.5h-69.2c-3.5 0-7 1.8-10.5 5.3L80.9 313.5V7.5q0-7.5-7.5-7.5H21.5Q14 0 14 7.5v497q0 7.5 7.5 7.5h51.9q7.5 0 7.5-7.5v-109l30.8-29.3 110.5 140.6c3 3.5 6.5 5.3 10.5 5.3h66.9q5.25 0 6-3z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://public.tableau.com/profile/iyadavvaibhav" target="_blank" rel="noopener" title="public.tableau.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.654.174v2.203H9.682v.58h1.972V5.16h.696V2.957h1.97v-.58h-1.97V.174h-.348zm6.03 2.262-.002 1.623v1.623h-2.957v.927h2.957v3.188h1.043l.011-1.582.02-1.576 1.465-.02 1.46-.01v-.927h-2.953V2.436h-.522zm-12.407.06v3.19H2.291v.925h2.986v3.19h.985V6.61h3.013v-.925H6.262V2.496H5.77zm6.086 5.27v3.593H8.06v1.188h3.304v3.596h1.28v-3.596h3.309v-1.188h-3.31V7.766h-.637zm9.721 1.55v2.221h-2.012v.811h2.012v2.261h.887v-2.261H24v-.811h-2.029v-2.22h-.422zm-19.111.131v2.174H0v.621h1.973v2.194h.667v-2.194h2v-.62H2.609V9.446h-.318zm15.709 4.516v3.254h-3.016v.927h3.016v3.217h1.072v-3.216h2.986v-.928h-2.986v-3.254h-.533zm-12.463.008v3.246H2.262v.928h2.957v3.189H6.32v-3.189h2.955v-.928H6.32V13.97h-.55zm6.316 4.578.002 1.103v1.1H9.566v.812h1.971v2.262h.928l.012-1.119.017-1.143h1.969v-.812h-2v-2.203h-.465z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.follow", "navigation.top", "search.highlight", "search.suggest", "content.action.edit", "content.action.view", "content.code.copy"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fc8c2696.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../assets/javascripts/extra.js"></script>
      
        <script src="../../assets/javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>